import{d as T,r as n,e as _,c as x,g as e,w as i,a as $,u as l,i as I,b as k,h as M,F as H,j as W,k as B,E as O,l as ie,n as P,m as q,q as X,s as Y,v as G,p as J,f as K,x as Q,_ as Z,y as A,z,A as re,B as de,t as ve,C as pe,D as me,G as _e,H as fe,I as ge,J as be}from"./index-Cjrv12kg.js";const j=y=>(J("data-v-fb93322b"),y=y(),K(),y),he=j(()=>$("div",{class:"header"},"使用rust的image包进行图片裁剪然后通过webassembly进行调用，直接对大尺寸图片进行等比例裁剪",-1)),$e=j(()=>$("span",null,"需要裁剪成几行：",-1)),ye=j(()=>$("span",null,"需要裁剪成几列：",-1)),xe={key:0,class:"image-list"},we={class:"row"},ke={class:"col"},Ce=T({__name:"CropMulti",setup(y){const s=n(null),t=n([]),r=n(3),d=n(3),p=b=>{const m=b.raw,o=O.service({fullscreen:!0,text:"裁剪中..."});m.arrayBuffer().then(w=>{ie(new Uint8Array(w),r.value,d.value).forEach(h=>{const V=new Blob([new Uint8Array(h)],{type:"image/png"});t.value.push(URL.createObjectURL(V))}),P(()=>{o.close()})})},a=()=>{t.value=[],s.value.clearFiles()},g=()=>{t.value.forEach((b,m)=>{const o=document.createElement("a");o.href=b,o.download=`crop-${m+1}`,o.click()})};return(b,m)=>{const o=q,w=X,f=Y,h=G,V=Q;return _(),x("main",null,[he,e(w,{style:{"margin-bottom":"10px"}},{default:i(()=>[$("div",null,[$e,e(o,{modelValue:l(r),"onUpdate:modelValue":m[0]||(m[0]=C=>I(r)?r.value=C:null),min:1,max:10,onChange:a},null,8,["modelValue"])]),$("div",null,[ye,e(o,{modelValue:l(d),"onUpdate:modelValue":m[1]||(m[1]=C=>I(d)?d.value=C:null),min:1,max:10,onChange:a},null,8,["modelValue"])])]),_:1}),e(h,{ref_key:"upload",ref:s,action:"#","list-type":"picture","auto-upload":!1,limit:1,onChange:p},{default:i(()=>[e(f,null,{default:i(()=>[k("上传")]),_:1}),e(f,{onClick:M(a,["stop"])},{default:i(()=>[k("重置")]),_:1})]),_:1},512),l(t).length?(_(),x("div",xe,[(_(!0),x(H,null,W(new Array(l(r)).fill(0),(C,S)=>(_(),x("div",we,[(_(!0),x(H,null,W(new Array(l(d)).fill(0),(R,D)=>(_(),x("div",ke,[e(V,{style:{width:"100px"},src:l(t)[S*l(d)+D],fit:"contain"},null,8,["src"])]))),256))]))),256)),e(f,{type:"primary",onClick:g},{default:i(()=>[k("一键下载")]),_:1})])):B("",!0)])}}}),Ve=Z(Ce,[["__scopeId","data-v-fb93322b"]]),N=y=>(J("data-v-db341e69"),y=y(),K(),y),Ue=N(()=>$("div",{class:"header"},"使用rust的image包进行图片裁剪然后通过webassembly进行调用，自选尺寸后移动裁剪框进行进行裁剪",-1)),Ee={style:{padding:"20px"}},Ie=N(()=>$("span",null,"裁剪框的宽度：",-1)),Be={style:{padding:"20px"}},Se=N(()=>$("span",null,"裁剪框的高度：",-1)),Te={key:1,class:"image-box"},De={key:2,class:"image-box"},Le=T({__name:"CropSize",setup(y){const s=n(null),t=n(""),r=n(""),d=n(null),p=n(50),a=n(50),g=n(1),b=n(100),m=n(100),o=n(0),w=n(0),f=n(0),h=n(0),V=n(0),C=n(0),S=n(500),R=u=>{const v=u.raw;t.value=URL.createObjectURL(v);const c=new Image;c.src=t.value,c.onload=()=>{S.value=Math.min.call(null,c.width,500,document.body.clientWidth),console.log(c.width,c.height),g.value=S.value/c.width,b.value=c.width*g.value,m.value=c.height*g.value},v.arrayBuffer().then(U=>{d.value=U})},D=()=>{imageList.value=[],s.value.clearFiles()},ee=u=>{V.value=u.clientX,C.value=u.clientY},le=u=>{if(u.clientX&&u.clientY){const v=u.clientX-V.value,c=u.clientY-C.value;f.value+c+a.value<=500&&h.value+v+p.value<=500&&f.value+c>=0&&h.value+v>=0&&(o.value=f.value+c,w.value=h.value+v)}},te=u=>{f.value=o.value,h.value=w.value},ae=u=>{u.preventDefault(),u.stopPropagation()},ne=u=>{const{clientX:v,clientY:c}=u.touches[0];V.value=v,C.value=c},oe=u=>{if(u.touches.length){const{clientX:v,clientY:c}=u.touches[0],U=v-V.value,E=c-C.value;f.value+E+a.value<=500&&h.value+U+p.value<=500&&f.value+E>=0&&h.value+U>=0&&(o.value=f.value+E,w.value=h.value+U)}},se=u=>{f.value=o.value,h.value=w.value},ue=()=>{const u=O.service({fullscreen:!0,text:"裁剪中..."}),v=de(new Uint8Array(d.value),Math.floor(w.value/g.value),Math.floor(o.value/g.value),Math.floor(p.value/g.value),Math.floor(a.value/g.value)),c=new Blob([new Uint8Array(v)],{type:"image/png"});r.value=URL.createObjectURL(c),P(()=>{u.close()})};return(u,v)=>{const c=re,U=X,E=Y,ce=G,F=Q;return _(),x("main",null,[Ue,l(t)?(_(),A(U,{key:0,style:{"margin-bottom":"10px"}},{default:i(()=>[$("div",Ee,[Ie,e(c,{modelValue:l(p),"onUpdate:modelValue":v[0]||(v[0]=L=>I(p)?p.value=L:null),min:50,max:l(b)},null,8,["modelValue","max"])]),$("div",Be,[Se,e(c,{modelValue:l(a),"onUpdate:modelValue":v[1]||(v[1]=L=>I(a)?a.value=L:null),min:50,max:l(m)},null,8,["modelValue","max"])])]),_:1})):B("",!0),e(ce,{ref_key:"upload",ref:s,action:"#","list-type":"picture","auto-upload":!1,limit:1,onChange:R},{default:i(()=>[e(E,null,{default:i(()=>[k("上传")]),_:1}),e(E,{onClick:M(D,["stop"])},{default:i(()=>[k("重置")]),_:1}),l(t)?(_(),A(E,{key:0,onClick:M(ue,["stop"])},{default:i(()=>[k("裁剪")]),_:1})):B("",!0)]),_:1},512),l(t)?(_(),x("div",Te,[e(F,{style:z({width:`${l(S).value}px`}),src:l(t),fit:"full"},null,8,["style","src"]),$("div",{class:"crop-box",style:z({width:`${l(p)}px`,height:`${l(a)}px`,top:`${l(o)}px`,left:`${l(w)}px`}),draggable:"true",onDragstart:ee,onDrag:le,onDragend:te,onDragover:ae,onTouchstart:ne,onTouchmove:oe,onTouchend:se},null,36)])):B("",!0),l(r)?(_(),x("div",De,[e(F,{src:l(r),style:z({width:`${l(b).value}px`}),fit:"full"},null,8,["src","style"])])):B("",!0)])}}}),ze=Z(Le,[["__scopeId","data-v-db341e69"]]),Me=$("div",null,"使用rust来进行大数的计算后转成字符串输出，这样可以拓展js的精算范围，但是只是对整数比较友好，浮点数跟js是一样的，都是双精度的，浮点数的计算能力其实跟js差不多。不过也可以借助第三方库类似BigFloat等来实现值比较大的高精度的浮点数计算",-1),Ae={key:0},Xe=T({__name:"BigNumberCaculate",setup(y){const s=n(123456789),t=n(123456789),r=n(""),d=p=>{switch(p){case 1:r.value=`${s.value} + ${t.value} = ${fe(`${s.value}`,`${t.value}`)}`;break;case 2:r.value=`${s.value} - ${t.value} = ${_e(`${s.value}`,`${t.value}`)}`;break;case 3:r.value=`${s.value} x ${t.value} = ${me(`${s.value}`,`${t.value}`)}`;break;case 4:r.value=`${s.value} / ${t.value} = ${pe(`${s.value}`,`${t.value}`)}`;break}};return(p,a)=>{const g=q,b=X,m=Y;return _(),A(b,{alignment:"flex-start",direction:"vertical",size:"20",class:"big-numebr-caculate"},{default:i(()=>[Me,e(b,{size:"10"},{default:i(()=>[e(g,{modelValue:l(s),"onUpdate:modelValue":a[0]||(a[0]=o=>I(s)?s.value=o:null),precision:0},null,8,["modelValue"]),e(g,{modelValue:l(t),"onUpdate:modelValue":a[1]||(a[1]=o=>I(t)?t.value=o:null),precision:0},null,8,["modelValue"])]),_:1}),e(b,{size:"10"},{default:i(()=>[e(m,{onClick:a[2]||(a[2]=o=>d(1))},{default:i(()=>[k("加")]),_:1}),e(m,{onClick:a[3]||(a[3]=o=>d(2))},{default:i(()=>[k("减")]),_:1}),e(m,{onClick:a[4]||(a[4]=o=>d(3))},{default:i(()=>[k("乘")]),_:1}),e(m,{onClick:a[5]||(a[5]=o=>d(4))},{default:i(()=>[k("除")]),_:1})]),_:1}),l(r)?(_(),x("div",Ae,ve(l(r)),1)):B("",!0)]),_:1})}}}),je=T({__name:"Webassembly",setup(y){const s=n("crop-multi"),t=r=>{s.name=r.props.name};return(r,d)=>{const p=be;return _(),x("main",null,[e(l(ge),{modelValue:l(s),"onUpdate:modelValue":d[0]||(d[0]=a=>I(s)?s.value=a:null),class:"demo-tabs",onTabClick:t},{default:i(()=>[e(p,{label:"等比例裁剪",name:"crop-multi"},{default:i(()=>[e(Ve)]),_:1}),e(p,{label:"自选尺寸裁剪",name:"crop-size"},{default:i(()=>[e(ze)]),_:1}),e(p,{label:"大数计算",name:"big-number-caculate"},{default:i(()=>[e(Xe)]),_:1})]),_:1},8,["modelValue"])])}}});export{je as default};
