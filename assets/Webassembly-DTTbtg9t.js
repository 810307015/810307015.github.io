import{d as R,r as t,e as p,c as h,g as l,w as u,a as v,u as e,i as I,b as U,h as M,F as Y,j,k as $,E as H,l as ne,n as O,m as se,q as W,s as P,v as q,p as G,f as J,x as K,_ as Q,y as F,z as A,A as ce,B as ue,C as re,D as ie}from"./index-DRPOMqQe.js";const z=f=>(G("data-v-fb93322b"),f=f(),J(),f),de=z(()=>v("div",{class:"header"},"使用rust的image包进行图片裁剪然后通过webassembly进行调用，直接对大尺寸图片进行等比例裁剪",-1)),pe=z(()=>v("span",null,"需要裁剪成几行：",-1)),_e=z(()=>v("span",null,"需要裁剪成几列：",-1)),me={key:0,class:"image-list"},ve={class:"row"},fe={class:"col"},ge=R({__name:"CropMulti",setup(f){const g=t(null),n=t([]),r=t(3),i=t(3),_=x=>{const m=x.raw,s=H.service({fullscreen:!0,text:"裁剪中..."});m.arrayBuffer().then(w=>{ne(new Uint8Array(w),r.value,i.value).forEach(k=>{const V=new Blob([new Uint8Array(k)],{type:"image/png"});n.value.push(URL.createObjectURL(V))}),O(()=>{s.close()})})},d=()=>{n.value=[],g.value.clearFiles()},b=()=>{n.value.forEach((x,m)=>{const s=document.createElement("a");s.href=x,s.download=`crop-${m+1}`,s.click()})};return(x,m)=>{const s=se,w=W,y=P,k=q,V=K;return p(),h("main",null,[de,l(w,{style:{"margin-bottom":"10px"}},{default:u(()=>[v("div",null,[pe,l(s,{modelValue:e(r),"onUpdate:modelValue":m[0]||(m[0]=C=>I(r)?r.value=C:null),min:1,max:10,onChange:d},null,8,["modelValue"])]),v("div",null,[_e,l(s,{modelValue:e(i),"onUpdate:modelValue":m[1]||(m[1]=C=>I(i)?i.value=C:null),min:1,max:10,onChange:d},null,8,["modelValue"])])]),_:1}),l(k,{ref_key:"upload",ref:g,action:"#","list-type":"picture","auto-upload":!1,limit:1,onChange:_},{default:u(()=>[l(y,null,{default:u(()=>[U("上传")]),_:1}),l(y,{onClick:M(d,["stop"])},{default:u(()=>[U("重置")]),_:1})]),_:1},512),e(n).length?(p(),h("div",me,[(p(!0),h(Y,null,j(new Array(e(r)).fill(0),(C,E)=>(p(),h("div",ve,[(p(!0),h(Y,null,j(new Array(e(i)).fill(0),(T,B)=>(p(),h("div",fe,[l(V,{style:{width:"100px"},src:e(n)[E*e(i)+B],fit:"contain"},null,8,["src"])]))),256))]))),256)),l(y,{type:"primary",onClick:b},{default:u(()=>[U("一键下载")]),_:1})])):$("",!0)])}}}),he=Q(ge,[["__scopeId","data-v-fb93322b"]]),N=f=>(G("data-v-e447df12"),f=f(),J(),f),be=N(()=>v("div",{class:"header"},"使用rust的image包进行图片裁剪然后通过webassembly进行调用，自选尺寸后移动裁剪框进行进行裁剪",-1)),ye={style:{padding:"20px"}},xe=N(()=>v("span",null,"裁剪框的宽度：",-1)),we={style:{padding:"20px"}},ke=N(()=>v("span",null,"裁剪框的高度：",-1)),Ce={key:1,class:"image-box"},Ve={key:2,class:"image-box"},Ue=R({__name:"CropSize",setup(f){const g=t(null),n=t(""),r=t(""),i=t(null),_=t(50),d=t(50),b=t(1),x=t(100),m=t(100),s=t(0),w=t(0),y=t(0),k=t(0),V=t(0),C=t(0),E=t(500),T=o=>{const c=o.raw;n.value=URL.createObjectURL(c);const a=new Image;a.src=n.value,a.onload=()=>{E.value=Math.min(a.width,500),console.log(a.width,a.height),b.value=E.value/a.width,x.value=a.width*b.value,m.value=a.height*b.value},c.arrayBuffer().then(L=>{i.value=L})},B=()=>{imageList.value=[],g.value.clearFiles()},Z=o=>{V.value=o.clientX,C.value=o.clientY},ee=o=>{if(o.clientX&&o.clientY){const c=o.clientX-V.value,a=o.clientY-C.value;y.value+a+d.value<=500&&k.value+c+_.value<=500&&y.value+a>=0&&k.value+c>=0&&(s.value=y.value+a,w.value=k.value+c)}},te=o=>{y.value=s.value,k.value=w.value},le=o=>{o.preventDefault(),o.stopPropagation()},ae=()=>{const o=H.service({fullscreen:!0,text:"裁剪中..."}),c=ue(new Uint8Array(i.value),Math.floor(w.value/b.value),Math.floor(s.value/b.value),Math.floor(_.value/b.value),Math.floor(d.value/b.value)),a=new Blob([new Uint8Array(c)],{type:"image/png"});r.value=URL.createObjectURL(a),O(()=>{o.close()})};return(o,c)=>{const a=ce,L=W,S=P,oe=q,X=K;return p(),h("main",null,[be,e(n)?(p(),F(L,{key:0,style:{"margin-bottom":"10px"}},{default:u(()=>[v("div",ye,[xe,l(a,{modelValue:e(_),"onUpdate:modelValue":c[0]||(c[0]=D=>I(_)?_.value=D:null),min:50,max:e(x)},null,8,["modelValue","max"])]),v("div",we,[ke,l(a,{modelValue:e(d),"onUpdate:modelValue":c[1]||(c[1]=D=>I(d)?d.value=D:null),min:50,max:e(m)},null,8,["modelValue","max"])])]),_:1})):$("",!0),l(oe,{ref_key:"upload",ref:g,action:"#","list-type":"picture","auto-upload":!1,limit:1,onChange:T},{default:u(()=>[l(S,null,{default:u(()=>[U("上传")]),_:1}),l(S,{onClick:M(B,["stop"])},{default:u(()=>[U("重置")]),_:1}),e(n)?(p(),F(S,{key:0,onClick:M(ae,["stop"])},{default:u(()=>[U("裁剪")]),_:1})):$("",!0)]),_:1},512),e(n)?(p(),h("div",Ce,[l(X,{style:A({width:`${e(E).value}px`}),src:e(n),fit:"contain"},null,8,["style","src"]),v("div",{class:"crop-box",style:A({width:`${e(_)}px`,height:`${e(d)}px`,top:`${e(s)}px`,left:`${e(w)}px`}),draggable:"true",onDragstart:Z,onDrag:ee,onDragend:te,onDragover:le},null,36)])):$("",!0),e(r)?(p(),h("div",Ve,[l(X,{src:e(r),style:A({width:`${e(x).value}px`}),fit:"contain"},null,8,["src","style"])])):$("",!0)])}}}),Ee=Q(Ue,[["__scopeId","data-v-e447df12"]]),Ie=R({__name:"Webassembly",setup(f){const g=t("crop-multi"),n=r=>{g.name=r.props.name};return(r,i)=>{const _=ie;return p(),h("main",null,[l(e(re),{modelValue:e(g),"onUpdate:modelValue":i[0]||(i[0]=d=>I(g)?g.value=d:null),class:"demo-tabs",onTabClick:n},{default:u(()=>[l(_,{label:"等比例裁剪",name:"crop-multi"},{default:u(()=>[l(he)]),_:1}),l(_,{label:"自选尺寸裁剪",name:"crop-size"},{default:u(()=>[l(Ee)]),_:1})]),_:1},8,["modelValue"])])}}});export{Ie as default};
